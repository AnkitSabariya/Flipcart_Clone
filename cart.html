<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Cart - Flipkart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.css"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "flipkart-blue": "#2874f0",
              "flipkart-orange": "#ff9f00",
              "flipkart-bg": "#f1f3f6",
            },
          },
        },
      };
    </script>
    <style>
      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        25% {
          transform: translateY(-10px) rotate(5deg);
        }
        50% {
          transform: translateY(-5px) rotate(-5deg);
        }
        75% {
          transform: translateY(-15px) rotate(3deg);
        }
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-10px);
        }
        60% {
          transform: translateY(-5px);
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .float-icon {
        animation: float 3s ease-in-out infinite;
      }

      .float-icon:nth-child(2) {
        animation-delay: -0.5s;
      }
      .float-icon:nth-child(3) {
        animation-delay: -1s;
      }
      .float-icon:nth-child(4) {
        animation-delay: -1.5s;
      }
      .float-icon:nth-child(5) {
        animation-delay: -2s;
      }
      .float-icon:nth-child(6) {
        animation-delay: -2.5s;
      }

      .empty-cart-bounce {
        animation: bounce 2s infinite;
      }

      .fade-in-up {
        animation: fadeInUp 0.6s ease-out;
      }

      .cart-item {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .cart-item:hover {
        transform: translateY(-2px);
      }

      .remove-animation {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @media (prefers-reduced-motion: reduce) {
        .float-icon,
        .empty-cart-bounce,
        .fade-in-up {
          animation: none;
        }
      }
    </style>
  </head>
  <body class="bg-flipkart-bg">
    <nav id="mynavbar"></nav>

    <!-- Mobile search bar -->
    <div
      id="mobileSearchBar"
      class="lg:hidden w-full px-3 pt-2 hidden bg-white transform transition-all duration-300 ease-in-out origin-top scale-y-0 opacity-0"
    >
      <div
        class="flex items-center border border-gray-300 rounded-lg overflow-hidden shadow-sm"
      >
        <input
          id="searchMobile"
          type="text"
          placeholder="Search for products, brands and more"
          onkeydown="if(event.key==='Enter'){ searchProduct(); }"
          class="w-full px-4 py-3 text-sm text-gray-800 outline-none bg-white"
        />
        <button
          onclick="searchProduct()"
          class="bg-flipkart-bg px-4 py-3 hover:bg-gray-200 transition-colors"
        >
          <i class="ri-search-line text-flipkart-blue text-lg"></i>
        </button>
      </div>
    </div>

    <!-- Empty Cart State -->
    <div id="emptyCartState" class="hidden min-h-screen bg-flipkart-bg">
      <!-- Flipkart Header -->
      <div class="bg-white border-b border-gray-200 py-4">
        <div class="max-w-7xl mx-auto px-4 flex justify-center">
          <div class="flex space-x-8">
            <div
              class="text-flipkart-blue font-medium text-sm border-b-2 border-flipkart-blue pb-2"
            >
              Flipkart
            </div>
            <div class="text-gray-500 font-medium text-sm pb-2">
              FlightBoking
            </div>
          </div>
        </div>
      </div>

      <!-- Empty Cart Content -->
      <div class="flex items-center justify-center min-h-[80vh] px-4">
        <div class="text-center max-w-md mx-auto fade-in-up">
          <!-- Floating Icons Animation -->
          <div class="relative mb-8">
            <div class="w-64 h-40 mx-auto relative">
              <!-- Central Device -->
              <div class="absolute inset-0 flex items-center justify-center">
                <div
                  class="w-32 h-24 bg-gray-800 rounded-lg flex items-center justify-center empty-cart-bounce"
                >
                  <i class="ri-macbook-line text-4xl text-gray-400"></i>
                </div>
              </div>

              <!-- Floating Shopping Icons -->
              <div class="float-icon absolute top-2 left-8 text-2xl">ðŸ›’</div>
              <div class="float-icon absolute top-8 right-12 text-xl">ðŸ“±</div>
              <div class="float-icon absolute bottom-12 left-4 text-xl">ðŸ‘•</div>
              <div class="float-icon absolute bottom-8 right-8 text-2xl">
                ðŸŽ®
              </div>
              <div class="float-icon absolute top-16 left-16 text-lg">âŒš</div>
              <div class="float-icon absolute bottom-16 right-4 text-lg">
                ðŸ‘Ÿ
              </div>
            </div>
          </div>

          <h2 class="text-xl font-medium text-gray-800 mb-2">
            Your cart is empty!
          </h2>
          <p class="text-gray-600 text-sm mb-6">Add items to it now.</p>
          <a href="./index.html">
            <button
              onclick="window.location.reload()"
              class="bg-flipkart-blue hover:bg-blue-600 text-white px-8 py-3 rounded-sm font-medium text-sm transition-colors"
            >
              Shop now
            </button>
          </a>
        </div>
      </div>
    </div>

    <!-- Cart Content -->
    <div
      id="cartContent"
      class="bg-flipkart-bg min-h-screen py-4 px-3 md:px-6 lg:px-10"
    >
      <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Left: Cart Items -->
        <div class="lg:col-span-2 space-y-4">
          <!-- Delivery Location -->
          <div
            class="bg-white p-4 rounded-sm shadow-sm border border-gray-200 text-sm font-medium text-gray-700 flex justify-between items-center"
          >
            <div class="flex items-center space-x-2">
              <i class="ri-map-pin-line text-green-600"></i>
              <span
                >Deliver to:
                <strong class="text-gray-900">Rajkot - 360002</strong></span
              >
            </div>
            <button
              class="text-flipkart-blue font-semibold text-xs border border-flipkart-blue px-4 py-2 rounded-sm hover:bg-blue-50 transition-colors"
            >
              Change
            </button>
          </div>

          <!-- Cart Items Container -->
          <div id="itemscontainer" class="space-y-4"></div>
        </div>

        <!-- Right: Price Details -->
        <div
          class="bg-white rounded-sm shadow-sm border border-gray-200 h-fit sticky top-4"
        >
          <div class="p-4 border-b border-gray-200">
            <h2 class="font-semibold text-gray-700 text-sm tracking-wide">
              PRICE DETAILS
            </h2>
          </div>
          <div class="p-4 space-y-3 text-sm text-gray-700">
            <div class="flex justify-between items-center">
              <span>Price (<span id="items-count">0</span> items)</span>
              <span id="items-price" class="font-medium">â‚¹0</span>
            </div>
            <div class="flex justify-between items-center">
              <span>Discount</span>
              <span id="items-discount" class="text-green-600 font-medium"
                >âˆ’â‚¹0</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span>Coupons for you</span>
              <span id="items-coupon" class="text-green-600 font-medium"
                >âˆ’â‚¹0</span
              >
            </div>
            <div class="flex justify-between items-center">
              <span>Platform Fee</span>
              <span id="items-platform" class="font-medium">â‚¹0</span>
            </div>
            <div class="flex justify-between items-center">
              <span>Delivery Charges</span>
              <span class="text-green-600 font-medium">FREE</span>
            </div>
          </div>
          <hr class="border-gray-200" />
          <div class="p-4">
            <div
              class="flex justify-between font-bold text-gray-900 text-base mb-3"
            >
              <span>Total Amount</span>
              <span id="items-total">â‚¹0</span>
            </div>
            <div class="bg-green-50 p-3 rounded-sm mb-4">
              <p
                id="items-saving-text"
                class="text-green-700 text-sm font-medium text-center"
              >
                You will save â‚¹0 on this order
              </p>
            </div>
            <button
              onclick="placeOrder()"
              class="w-full bg-flipkart-orange hover:bg-orange-600 text-white py-3 px-4 rounded-sm font-bold text-sm tracking-wide transition-colors shadow-sm"
            >
              PLACE ORDER
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/script.js"></script>
    <script>
      let getcart = JSON.parse(localStorage.getItem("cart")) || [];
      let itemscontainer = document.getElementById("itemscontainer");

      function renderCart() {
        // Check if cart is empty
        if (getcart.length === 0) {
          document.getElementById("emptyCartState").classList.remove("hidden");
          document.getElementById("cartContent").classList.add("hidden");
          return;
        }

        document.getElementById("emptyCartState").classList.add("hidden");
        document.getElementById("cartContent").classList.remove("hidden");

        itemscontainer.innerHTML = "";

        getcart.forEach((e, i) => {
          const discountAmount = Math.round(
            (e.price * e.discountPercentage) / 100
          );
          const originalPrice = e.price + discountAmount;

          itemscontainer.innerHTML += `
                    <div class="cart-item bg-white rounded-sm shadow-sm border border-gray-200 hover:shadow-md">
                        <div class="flex flex-col sm:flex-row p-4 gap-4" id="iten-${
                          e.id
                        }-${e.json}">
                            <!-- Product Image -->
                            <div class="flex-shrink-0">
                                <div class="w-24 h-24 sm:w-28 sm:h-28 bg-white rounded-lg overflow-hidden flex items-center justify-center p-2">
                                    <img src="${
                                      e.images[0]
                                    }" class="w-full h-full object-contain" alt="${
            e.title
          }" />
                                </div>
                                <!-- Quantity Control -->
                                <div class="flex items-center justify-center space-x-3 mt-3 bg-gray-50 rounded-lg p-2">
                                    <button class="w-8 h-8 border border-gray-300 rounded-full text-gray-600 hover:border-flipkart-blue hover:text-flipkart-blue hover:bg-blue-50 transition-all duration-200 flex items-center justify-center font-medium touch-manipulation" onclick="decrement(${i})">
                                        <i class="ri-subtract-line text-sm"></i>
                                    </button>
                                    <span class="text-sm font-semibold min-w-[20px] text-center" id="quntanity${i}">${
            e.qty
          }</span>
                                    <button class="w-8 h-8 border border-gray-300 rounded-full text-gray-600 hover:border-flipkart-blue hover:text-flipkart-blue hover:bg-blue-50 transition-all duration-200 flex items-center justify-center font-medium touch-manipulation" onclick="increment(${i})">
                                        <i class="ri-add-line text-sm"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Product Details -->
                            <div class="flex-1 min-w-0">
                                <h3 class="font-semibold text-gray-900 text-base mb-1 line-clamp-2 leading-tight">${
                                  e.title
                                }</h3>
                                <div class="flex items-center space-x-2 mb-2">
                                    <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">${
                                      e.category
                                    }</span>
                                    <div class="flex items-center space-x-1">
                                        <span class="text-xs text-gray-500">Seller: Deconstruct</span>
                                        <img class="w-4 h-4" src="https://img.icons8.com/color/48/000000/verified-badge.png" alt="verified"/>
                                    </div>
                                </div>
                                
                                <div class="flex items-center space-x-3 mb-2">
                                    <span class="font-bold text-lg text-gray-900" id="price${i}">â‚¹${(
            e.price * e.qty
          ).toLocaleString()}</span>
                                    <span class="text-gray-500 line-through text-sm">â‚¹${(
                                      originalPrice * e.qty
                                    ).toLocaleString()}</span>
                                    <span class="text-green-600 font-medium text-sm">${
                                      e.discountPercentage
                                    }% off</span>
                                    <span class="hidden" id="unitprice${i}">${
            e.price
          }</span>
                                </div>
                                
                                <div class="flex items-center space-x-2 mb-3">
                                    <i class="ri-truck-line text-green-600 text-sm"></i>
                                    <span class="text-xs text-green-600 font-medium">Free Delivery by Mon Jul 14</span>
                                </div>
                                
                                <p class="text-xs text-gray-500 mb-3">Or Pay â‚¹260 + 16 coins</p>
                                
                                <div class="flex space-x-6 text-sm font-medium">
                                    <button class="text-gray-600 hover:text-flipkart-blue hover:underline transition-colors touch-manipulation">SAVE FOR LATER</button>
                                    <button class="text-gray-600 hover:text-red-600 hover:underline transition-colors touch-manipulation" onclick="remove(${
                                      e.id
                                    }, '${e.json}')">REMOVE</button>
                                </div>
                            </div>
                            
                            <!-- Delivery Info -->
                            <div class="text-xs text-gray-600 sm:ml-4 whitespace-nowrap self-start">
                                <div class="bg-green-50 px-3 py-2 rounded-sm">
                                    <i class="ri-time-line text-green-600 mr-1"></i>
                                    Delivery by Mon Jul 14
                                </div>
                            </div>
                        </div>
                    </div>
                `;
        });
      }

      // Price Details
      function updateSummary() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        let totalItems = 0;
        let totalPrice = 0;
        let totalDiscount = 0;
        let couponDiscount = cart.length > 0 ? 45 : 0;
        let platformFee = cart.length > 0 ? 4 : 0;

        cart.forEach((item) => {
          totalItems += item.qty;
          totalPrice += item.price * item.qty;
          totalDiscount += Math.round(
            ((item.price * item.discountPercentage) / 100) * item.qty
          );
        });

        if (totalItems === 0) {
          couponDiscount = 0;
          platformFee = 0;
        }

        const finalAmount =
          totalPrice - totalDiscount - couponDiscount + platformFee;
        const totalSaving = totalDiscount + couponDiscount;

        document.getElementById("items-count").innerText = totalItems;
        document.getElementById(
          "items-price"
        ).innerText = `â‚¹${totalPrice.toLocaleString()}`;
        document.getElementById(
          "items-discount"
        ).innerText = `âˆ’â‚¹${totalDiscount.toLocaleString()}`;
        document.getElementById(
          "items-coupon"
        ).innerText = `âˆ’â‚¹${couponDiscount}`;
        document.getElementById("items-platform").innerText = `â‚¹${platformFee}`;
        document.getElementById(
          "items-total"
        ).innerText = `â‚¹${finalAmount.toLocaleString()}`;
        document.getElementById(
          "items-saving-text"
        ).innerText = `You will save â‚¹${totalSaving.toLocaleString()} on this order`;
      }

      // Increment decrement
      function decrement(index) {
        let price = document.getElementById(`price${index}`);
        let unitprice = +document.getElementById(`unitprice${index}`).innerText;
        let quntanity = document.getElementById(`quntanity${index}`);
        let value = +quntanity.innerText;

        if (value > 1) {
          value--;
          getcart[index].qty = value;
          localStorage.setItem("cart", JSON.stringify(getcart));

          price.innerText = `â‚¹${(unitprice * value).toLocaleString()}`;
          quntanity.innerText = value;
          updateSummary();
          if (typeof updateCartCounter === "function") updateCartCounter();
        }
      }

      function increment(index) {
        let price = document.getElementById(`price${index}`);
        let unitprice = +document.getElementById(`unitprice${index}`).innerText;
        let quntanity = document.getElementById(`quntanity${index}`);
        let value = +quntanity.innerText;

        if (value < 10) {
          value++;
          getcart[index].qty = value;
          localStorage.setItem("cart", JSON.stringify(getcart));

          price.innerText = `â‚¹${(unitprice * value).toLocaleString()}`;
          quntanity.innerText = value;
          updateSummary();
          if (typeof updateCartCounter === "function") updateCartCounter();
        }
      }

      // Delete Items
      function remove(id, json) {
        let findindex = getcart.findIndex(
          (find) => find.id === id && find.json == json
        );
        if (findindex !== -1) {
          let item = document.getElementById(`iten-${id}-${json}`);
          let cartItem = item.parentElement;

          // Add remove animation
          cartItem.classList.add("remove-animation");
          cartItem.style.transform = "translateX(100%)";
          cartItem.style.opacity = "0";

          setTimeout(() => {
            getcart.splice(findindex, 1);
            localStorage.setItem("cart", JSON.stringify(getcart));
            renderCart();
            updateSummary();
            if (typeof updateCartCounter === "function") updateCartCounter();
          }, 400);
        }
      }

      function searchProduct() {
        console.log("Search functionality");
      }

      // Initialize
      renderCart();
      updateSummary();
      function placeOrder() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
    }
    
    // Navigate to bill page
    window.location.href = "bill.html";
}
    </script>
  </body>
</html>
